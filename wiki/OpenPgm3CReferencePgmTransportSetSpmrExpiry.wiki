#summary OpenPGM 3 : C Reference : Transport : pgm_transport_set_spmr_expiry()
#labels Phase-Implementation
#sidebar TOC3CReferenceTransport
_Function_
=== Declaration ===
<pre>
#include <pgm/pgm.h>

bool *pgm_transport_set_spmr_expiry* (
	[OpenPgm3CReferencePgmTransportT pgm_transport_t]`*`     transport,
	unsigned                spmr_expiry
	);
</pre>

=== Purpose ===
Set expiration time of SPM Requests.

=== Remarks ===
If a subscriber joins a high speed publishing feed, at a publishing rate such that no heartbeat SPM packets are generated, the subscriber will have to wait for the next ambient SPM before it can request repair via NAKs. SPM Requests (SPMRs) may be used to solicit an SPM without having to wait for the next scheduled delivery.

Before unicasting a given SPMR, receivers must choose a random delay on <tt>SPMR_BO_IVL</tt> (~250ms) during which they listen for a multicast of an identical SPMR.  If a receiver does not see a matching multicast SPMR within its chosen random interval, it must first multicast its own SPMR to the group with a TTL of 1 before then unicasting its own SPMR to the source.  If a receiver does see a matching multicast SPMR within its chosen random interval, it must refrain from unicasting its SPMR and wait instead for the corresponding SPM.

The receiver must wait at least <tt>SPMR_SPM_IVL</tt> before attempting to repeat the SPMR by choosing another delay on <tt>SPMR_BO_IVL</tt> and repeating the procedure above.

=== Parameters ===
<table border="1" cellpadding="5" cellspacing="0">
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
<tr>
<td><tt>transport</tt></td>
<td>The PGM transport object.</td>
</tr><tr>
<td><tt>spmr_expiry</tt></td>
<td>Expiration time in microseconds.</td>
</tr>
</table>


=== Return Value ===
On success, returns <tt>true</tt>.  On invalid parameter, returns <tt>false</tt>.

=== Example ===
Set SPMR expiration period to 250ms.

{{{
 pgm_transport_set_spmr_expiry (transport, 250*1000);
}}}

=== See Also ===
  * <tt>[OpenPgm3CReferencePgmTransportT pgm_transport_t]</tt><br>
  * <tt>[OpenPgm3CReferencePgmTransportSetAmbientSpm pgm_transport_set_ambient_spm()]</tt><br>
  * [OpenPgm3CReferenceTransport Transport] in OpenPGM C Reference.

